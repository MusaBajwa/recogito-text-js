!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Recogito",[],e):"object"==typeof exports?exports.Recogito=e():t.Recogito=e()}(window,(function(){return function(t){function e(e){for(var o,a,c=e[0],l=e[1],u=e[2],d=0,f=[];d<c.length;d++)a=c[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);for(s&&s(e);f.length;)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(o=!1)}o&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},r={0:0},i=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var c=window.webpackJsonpRecogito=window.webpackJsonpRecogito||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var s=l;return i.push([52,1]),n()}({48:function(t,e,n){var o=n(49);"string"==typeof o&&(o=[[t.i,o,""]]);var r={insert:"head",singleton:!1};n(51)(o,r);o.locals&&(t.exports=o.locals)},49:function(t,e,n){(t.exports=n(50)(!1)).push([t.i,".r6o-btn{background-color:#4483c4;border:1px solid #4483c4;box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-size:14px;margin:0;outline:none;text-decoration:none;white-space:nowrap;padding:6px 18px;min-width:70px;vertical-align:middle;-webkit-border-radius:2px;-khtml-border-radius:2px;-moz-border-radius:2px;border-radius:2px}.r6o-btn *{vertical-align:middle}.r6o-btn .icon{margin-right:4px}.r6o-btn:disabled{border-color:#a3c2e2 !important;background-color:#a3c2e2 !important}.r6o-btn:hover{background-color:#4f92d7;border-color:#4f92d7}.r6o-btn.outline{border:1px solid #4483c4;color:#4483c4;background-color:transparent;text-shadow:none}.annotation{background-color:#ffa50033;border-bottom:2px solid orange;cursor:pointer}.selection{background-color:#cfcfffa1;cursor:pointer}.r6o-section.comment{font-size:14px;min-height:3em;background-color:#fff;position:relative}.r6o-section.comment .arrow-down{position:absolute;top:5px;right:5px;height:20px;width:20px;line-height:14px;font-size:18px;background-color:#fff;text-align:center;text-rendering:auto;-webkit-font-smoothing:antialiased;border:1px solid #e5e5e5;top:9px;right:9px;cursor:pointer;-webkit-border-radius:1px;-khtml-border-radius:1px;-moz-border-radius:1px;border-radius:1px}.r6o-section.comment .arrow-down::before{content:'\\2304'}.r6o-section.comment .arrow-down.menu-open{border-color:#4483c4}.r6o-section.comment .comment-dropdown-menu{position:absolute;top:32px;right:8px;background-color:#fff;border:1px solid #e5e5e5;list-style-type:none;margin:0;padding:5px 0;z-index:9999;-webkit-box-shadow:0 2px 4px rgba(0,0,0,0.2);-moz-box-shadow:0 2px 4px rgba(0,0,0,0.2);box-shadow:0 2px 4px rgba(0,0,0,0.2)}.r6o-section.comment .comment-dropdown-menu li{padding:0 15px;cursor:pointer}.r6o-section.comment .comment-dropdown-menu li:hover{background-color:#ecf0f1}.r6o-section.comment.editable{background-color:#ecf0f1}.r6o-section.semantic-tag .icon{display:inline-block;padding:7px 10px;color:#9ca4b1}.r6o-section.semantic-tag .icon svg{vertical-align:middle}.r6o-section.semantic-tag input{border:none;outline:none;background-color:#ecf0f1;padding:3px;width:80%;-webkit-border-radius:2px;-khtml-border-radius:2px;-moz-border-radius:2px;border-radius:2px}.r6o-editable-text{padding:8px 10px;max-height:120px;overflow:auto;outline:none;min-height:3em;font-size:14px}.r6o-editable-text:empty:not(:focus):before{content:attr(data-placeholder);color:#c2c2c2}.tags{background-color:#ecf0f1;border-bottom:1px solid #e5e5e5;padding:1px 3px}.tags ul,.tags li{padding:0;margin:0;display:inline}.tags li{display:inline-block;margin:1px 1px 1px 0;padding:0;vertical-align:middle;overflow:hidden;font-size:12px;background-color:#fff;border:1px solid #d6d7d9;cursor:pointer;position:relative;line-height:180%;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-border-radius:2px;-khtml-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-webkit-box-shadow:0 0 4px rgba(0,0,0,0.1);-moz-box-shadow:0 0 4px rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1)}.tags li .label{padding:2px 8px;display:inline-block}.tags li .delete-wrapper{display:inline-block;padding:2px 0;color:#fff;width:0;height:100%;background-color:#4483c4;vertical-align:top}.tags li .delete-wrapper .delete{padding:2px 6px}.tags li .delete-wrapper .delete .icon{height:11px;padding-bottom:1px}.tags li .delete-enter-active{width:24px;transition:width 200ms}.tags li .delete-enter-done{width:24px}.tags li .delete-exit{width:24px}.tags li .delete-exit-active{width:0;transition:width 200ms}.tags input{padding:0 3px;min-width:80px;outline:none;border:none;line-height:170%;background-color:transparent;color:#3f3f3f}.tags input::-webkit-input-placeholder{color:#c2c2c2}.tags input::-moz-placeholder{color:#c2c2c2}.tags input:-moz-placeholder{color:#c2c2c2}.tags input:-ms-input-placeholder{color:#c2c2c2}.type-selector{display:flex;border-bottom:1px solid #e5e5e5}.type-selector .type{flex:1;text-align:center;padding:7px;font-size:14px}.type-selector .type{cursor:pointer;border-right:1px solid #e5e5e5}.type-selector .type:last-child{border-right:none}.type-selector .type:hover{background-color:#f5f7f7}.type-selector .icon{margin:0 3px 1px 0;height:13px}.r6o-editor{position:absolute;z-index:99999;margin-top:18px;margin-left:-14px;width:400px;color:#3f3f3f}.r6o-editor .arrow{position:absolute;overflow:hidden;top:-12px;left:12px;width:28px;height:12px}.r6o-editor .arrow:after{content:'';position:absolute;top:5px;left:5px;width:18px;height:18px;background-color:#fff;-webkit-backface-visibility:hidden;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.r6o-editor .inner{background-color:#fff;-webkit-border-radius:2px;-khtml-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-webkit-box-shadow:2px 2px 42px rgba(0,0,0,0.4);-moz-box-shadow:2px 2px 42px rgba(0,0,0,0.4);box-shadow:2px 2px 42px rgba(0,0,0,0.4)}.r6o-editor .inner .r6o-section:first-child{-webkit-border-top-left-radius:2px;-webkit-border-top-right-radius:2px;-khtml-border-radius-topleft:2px;-khtml-border-radius-topright:2px;-moz-border-radius-topleft:2px;-moz-border-radius-topright:2px;border-top-left-radius:2px;border-top-right-radius:2px}.r6o-editor .inner .r6o-section{border-bottom:1px solid #d6d7d9}.r6o-editor .footer{text-align:right;padding:8px 0}.r6o-editor .footer .r6o-btn{margin-right:8px}.r6o-editor.align-right{margin-left:8px}.r6o-editor.align-right .arrow{left:auto;right:12px}.r6o-editor.align-bottom{margin-bottom:14px}.r6o-editor.align-bottom .arrow{top:auto;bottom:-12px}.r6o-editor.align-bottom .arrow::after{top:-11px;box-shadow:none}\n",""])},52:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),i=n(5),a=n.n(i),c=n(18),l=n.n(c),u=n(19),s=n.n(u);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,"clone",(function(e){return new t(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(n,!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n._annotation,{},e))})),p(this,"selector",(function(t){return n._annotation.target.selector.find((function(e){return e.type===t}))})),this._annotation=e}var e,n,o;return e=t,(n=[{key:"isEqual",value:function(t){return!(!t||this._annotation!==t._annotation&&(!this._annotation.id||!t._annotation.id||this._annotation.id!==t._annotation.id))}},{key:"id",get:function(){return this._annotation.id}},{key:"type",get:function(){return this._annotation.type}},{key:"body",get:function(){return this._annotation.body}},{key:"target",get:function(){return this._annotation.target}},{key:"bodies",get:function(){return Array.isArray(this._annotation.body)?this._annotation.body:[this._annotation.body]},set:function(t){this._annotation.body=t}},{key:"quote",get:function(){return this.selector("TextQuoteSelector").exact}},{key:"start",get:function(){return this.selector("TextPositionSelector").start}},{key:"end",get:function(){return this.selector("TextPositionSelector").end}}])&&f(e.prototype,n),o&&f(e,o),t}();function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var m=function t(e){e.forEach((function(t){var e=function(t){return Array.from(t.childNodes).reduce((function(t,e){if(e.nodeType===Node.TEXT_NODE){if(e.textContent.trim().length>0){var n=e.textContent.replace(/\s\s+/g," ");return[].concat(h(t),[document.createTextNode(n)])}return t}return[].concat(h(t),[e])}),[])}(t);t.innerHTML="",e.forEach((function(e){return t.appendChild(e)}))}));var n=e.reduce((function(t,e){return t.concat(Array.from(e.childNodes).filter((function(t){return t.firstChild})))}),[]);n.length>0&&t(n)};function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=3,x=function(t){return Array.from(new Set(t))},O=function(){function t(e,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),v(this,"init",(function(t){t.forEach((function(t){return o._addAnnotation(t)}))})),v(this,"_addAnnotation",(function(t){var e=g(o.charOffsetsToDOMPosition([t.start,t.end]),2),n=e[0],r=e[1],i=document.createRange();i.setStart(n.node,n.offset),i.setEnd(r.node,r.offset);var a=o.wrapRange(i);o.applyStyles(t,a),o.bindAnnotation(t,a)})),v(this,"_findAnnotationSpans",(function(t){var e=document.querySelectorAll(".annotation");return Array.prototype.slice.call(e).filter((function(e){return e.annotation.isEqual(t)}))})),v(this,"addOrUpdateAnnotation",(function(t,e){var n=o._findAnnotationSpans(t),r=e?o._findAnnotationSpans(e):[],i=x(n.concat(r));i.length>0?(o._unwrapHighlightings(i),o._addAnnotation(t)):o._addAnnotation(t)})),v(this,"removeAnnotation",(function(t){var e=o._findAnnotationSpans(t);e&&(o._unwrapHighlightings(e),o.el.normalize())})),v(this,"applyStyles",(function(t,e){var n=o.formatter?o.formatter(t):"";e.forEach((function(t){return t.className="annotation ".concat(n).trim()}))})),v(this,"bindAnnotation",(function(t,e){e.forEach((function(e){e.annotation=t,t.id&&(e.dataset.id=t.id)}))})),v(this,"walkTextNodes",(function(t,e,n){var r,i=n||[],a=!0;if((r=0,i.forEach((function(t){r+=t.textContent.length})),r)>e)return!1;for(t.nodeType===w&&i.push(t),t=t.firstChild;t&&a;)a=o.walkTextNodes(t,e,i),t=t.nextSibling;return i})),v(this,"charOffsetsToDOMPosition",(function(t){var e,n=Math.max.apply(null,t),r=(e=0,o.walkTextNodes(o.el,n).map((function(t){var n=t.textContent.length,o={node:t,start:e,end:e+n};return e+=n,o})));return o.calculateDomPositionWithin(r,t)})),v(this,"textNodesBetween",(function(t,e,n){var r,i,a,c=((a=document.createRange()).setStart(n,0),a.setEnd(e,e.textContent.length),a.toString().length),l=o.walkTextNodes(n,c),u=[],s=l.length,d=!1;for(i=0;i<s;i++)(r=l[i])===e&&(d=!1),d&&u.push(r),r===t&&(d=!0);return u})),v(this,"calculateDomPositionWithin",(function(t,e){var n=[];return t.forEach((function(t,o){return e.forEach((function(e,o){e>=t.start&&e<=t.end&&((n.length>0&&n[n.length-1].charOffset)!==e&&n.push({charOffset:e,node:t.node,offset:e-t.start}))})),n.length<e.length})),n})),v(this,"wrapRange",(function(t,e){var n=e||o.el,r=function(t){var e=document.createElement("SPAN");return t.surroundContents(e),e};if(t.startContainer===t.endContainer)return[r(t)];var i=o.textNodesBetween(t.startContainer,t.endContainer,n),a=document.createRange();a.selectNodeContents(t.startContainer),a.setStart(t.startContainer,t.startOffset);var c=r(a),l=document.createRange();l.selectNode(t.endContainer),l.setEnd(t.endContainer,t.endOffset);var u=r(l),s=i.reverse().map((function(t){var e=document.createElement("SPAN");return t.parentNode.insertBefore(e,t),e.appendChild(t),e}));return[c].concat(s,[u])})),v(this,"getAnnotationsAt",(function(t){return function(t){return t.sort((function(t,e){return new b(t).quote.length-new b(e).quote.length}))}(function t(e,n){var o=n||[],r=e.parentNode;return o.push(e.annotation),r.classList.contains("annotation")?t(r,o):o}(t))})),this.el=e,this.formatter=n}var e,n,o;return e=t,(n=[{key:"_unwrapHighlightings",value:function(t){var e=!0,n=!1,o=void 0;try{for(var r,i=t[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value,c=a.parentNode;c.insertBefore(document.createTextNode(a.textContent),a),c.removeChild(a)}}catch(t){n=!0,o=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw o}}}}])&&y(e.prototype,n),o&&y(e,o),t}();function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(n,!0).forEach((function(e){j(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,"clone",(function(e){var o=new t(n._stub.target.selector.map((function(t){return S({},t)})));return e&&(o._stub=S({},o._stub,{},e)),o})),j(this,"selector",(function(t){return n._stub.target.selector.find((function(e){return e.type===t}))})),j(this,"toAnnotation",(function(){var t=Object.assign({},n._stub,{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation"});return new b(t)})),this._stub={type:"Selection",body:[],target:{selector:e}}}var e,n,o;return e=t,(n=[{key:"type",get:function(){return this._stub.type}},{key:"body",get:function(){return this._stub.body}},{key:"target",get:function(){return this._stub.target}},{key:"bodies",get:function(){return this._stub.body}},{key:"quote",get:function(){return this.selector("TextQuoteSelector").exact}},{key:"isSelection",get:function(){return!0}}])&&k(e.prototype,n),o&&k(e,o),t}(),_=function(t){for(var e=t.toString(),n=0,o=0;" "===e.substring(0,1);)n+=1,e=e.substring(1);for(;" "===e.substring(e.length-1);)o+=1,e=e.substring(0,e.length-1);return n>0&&t.setStart(t.startContainer,t.startOffset+n),o>0&&t.setEnd(t.endContainer,t.endOffset-o),t},C=function(t,e){var n=document.createRange();n.setStart(e,0),n.setEnd(t.startContainer,t.startOffset);var o=t.toString(),r=n.toString().length;return new A([{type:"TextQuoteSelector",exact:o},{type:"TextPositionSelector",start:r,end:r+o.length}])},P=function(t,e){var n,o,r=function(){o&&(e(o),n=null,o=null)};t.addEventListener("touchstart",(function(t){n||(o=t,n=setTimeout(r,1e3))})),document.addEventListener("selectionchange",(function(t){n&&(clearTimeout(n),n=setTimeout(r,1500))}))},N=n(20),T=n.n(N);function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t,e){return(U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M="ontouchstart"in window||navigator.maxTouchPoints>0,L=function(t){function e(t,n){var o,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,i=D(e).call(this),o=!i||"object"!==R(i)&&"function"!=typeof i?z(r):i,B(z(o),"_onTouchend",(function(t){})),B(z(o),"_onMouseDown",(function(t){o.clearSelection()})),B(z(o),"_onMouseUp",(function(t){var e=getSelection();if(e.isCollapsed){var n=t.target.closest(".annotation");n?o.emit("select",{selection:o.highlighter.getAnnotationsAt(n)[0],clientRect:n.getBoundingClientRect()}):o.emit("select",{})}else{var r=_(e.getRangeAt(0)),i=C(r,o.el),a=r.getBoundingClientRect();o.highlighter.wrapRange(r).forEach((function(t){return t.className="selection"})),o._clearNativeSelection(),o.emit("select",{selection:i,clientRect:a})}})),B(z(o),"_clearNativeSelection",(function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()})),B(z(o),"clearSelection",(function(){o._currentSelection=null;var t=Array.prototype.slice.call(o.el.querySelectorAll(".selection"));t&&t.forEach((function(t){var e=t.parentNode;e.insertBefore(document.createTextNode(t.textContent),t),e.removeChild(t)})),o.el.normalize()})),o.el=t,o.highlighter=n,t.addEventListener("mousedown",o._onMouseDown),t.addEventListener("mouseup",o._onMouseUp),M&&P(t,o._onMouseUp),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(e,t),e}(T.a),q=function(t,e,n){var o=t.offsetLeft,r=t.offsetTop,i=window,a=i.scrollX,c=i.scrollY;e.className="r6o-editor";var l=n.x,u=n.y,s=n.height,d=n.top,f=n.right;e.style.top="".concat(u+s+c-r,"px"),e.style.left="".concat(l+a-o,"px");var p=e.getBoundingClientRect();if(p.right>window.innerWidth&&(e.classList.add("align-right"),e.style.left="".concat(f-p.width+a-o,"px")),p.bottom>window.innerHeight){var b=d+c,h=t.getBoundingClientRect(),m=h.height+h.top+c;e.classList.add("align-bottom"),e.style.top="auto",e.style.bottom="".concat(m-b,"px")}},H=n(4),I=n(3),K=n(54);function Q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var V=function(t){var e=Q(Object(o.useState)(!1),2),n=e[0],i=e[1],a=Q(Object(o.useState)(""),2),c=a[0],l=a[1],u=t.annotation?t.annotation.bodies.filter((function(t){return"tagging"===t.purpose})):[],s=function(t){return function(e){i(n!==t&&t)}},d=function(e){return function(n){n.stopPropagation(),t.onRemoveTag(e)}};return r.a.createElement("div",{className:"tags"},r.a.createElement("ul",null,u.map((function(t){return r.a.createElement("li",{key:t.value,onClick:s(t.value)},r.a.createElement("span",{className:"label"},t.value),r.a.createElement(K.a,{in:n===t.value,timeout:200,classNames:"delete"},r.a.createElement("span",{className:"delete-wrapper",onClick:d(t)},r.a.createElement("span",{className:"delete"},r.a.createElement(H.a,{className:"icon",icon:I.c})))))}))),r.a.createElement("input",{type:"text",value:c,onChange:function(t){return l(t.target.value)},onKeyDown:function(e){13===e.which&&(t.onAddTag({type:"TextualBody",purpose:"tagging",value:c.trim()}),l(""))},placeholder:"Add tag..."}))},W=function(t){var e=function(e){return function(n){t.onSelect&&t.onSelect(e)}};return r.a.createElement("div",{className:"type-selector"},r.a.createElement("div",{className:"type place",onClick:e("PLACE")},r.a.createElement(H.a,{className:"icon",icon:I.a})," Place"),r.a.createElement("div",{className:"type person",onClick:e("PERSON")},r.a.createElement(H.a,{className:"icon",icon:I.d})," Person"),r.a.createElement("div",{className:"type event",onClick:e("EVENT")},r.a.createElement(H.a,{className:"icon",icon:I.b})," Event"))};var J=function(t){var e=Object(o.useRef)();return function(t,e){var n=function(n){t.current&&!t.current.contains(event.target)&&e()};Object(o.useEffect)((function(){return document.addEventListener("mousedown",n),function(){return document.removeEventListener("mousedown",n)}}))}(e,(function(){return t.onClickOutside()})),r.a.createElement("ul",{ref:e,className:"comment-dropdown-menu"},r.a.createElement("li",{onClick:t.onEdit},"Edit"),r.a.createElement("li",{onClick:t.onDelete},"Delete"))},X=n(21),F=n.n(X);function Y(t){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function et(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var nt=function(t){function e(){var t,n,o,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return o=this,r=(t=Z(e)).call.apply(t,[this].concat(a)),n=!r||"object"!==Y(r)&&"function"!=typeof r?$(o):r,et($(n),"onKeyDown",(function(t){13===t.which&&t.ctrlKey&&n.props.onOk()})),et($(n),"onRender",(function(t){t&&n.props.editable&&t.focus()})),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(e,t),n=e,(o=[{key:"render",value:function(){var t=this;return r.a.createElement(F.a,{innerRef:this.onRender,className:"r6o-editable-text",html:this.props.content,"data-placeholder":"Add a comment...",disabled:!this.props.editable,onChange:function(e){return t.props.onChange(e)},onKeyDown:this.onKeyDown})}}])&&G(n.prototype,o),i&&G(n,i),e}(o.Component);function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function rt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var at=function(t){var e=it(Object(o.useState)(!1),2),n=e[0],i=e[1],a=it(Object(o.useState)(!1),2),c=a[0],l=a[1];return t.readOnly?r.a.createElement("div",{className:"r6o-section comment"},t.body.value):r.a.createElement("div",{className:n?"r6o-section comment editable":"r6o-section comment"},r.a.createElement(nt,{editable:n,content:t.body.value,onChange:function(e){t.onUpdate(t.body,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(n,!0).forEach((function(e){rt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t.body,{value:e.target.value}))},onOk:t.onOk}),r.a.createElement("div",{className:c?"icon arrow-down menu-open":"icon arrow-down",onClick:function(){return l(!c)}}),c&&r.a.createElement(J,{onEdit:function(t){i(!0),l(!1)},onDelete:function(e){t.onDelete(t.body),l(!1)},onClickOutside:function(){return l(!1)}}))},ct=function(t){var e=t.annotation?t.annotation.bodies.filter((function(t){return!t.hasOwnProperty("purpose")||"commenting"===t.purpose||"replying"===t.purpose})):[];return r.a.createElement(r.a.Fragment,null,e.map((function(e,n){return r.a.createElement(at,{key:n,readOnly:t.readOnly,body:e,onUpdate:t.onUpdateComment,onDelete:t.onDeleteComment,onOk:t.onOk})})),!t.readOnly&&r.a.createElement("div",{className:"r6o-section comment editable"},r.a.createElement(nt,{content:t.currentReply,editable:!0,onChange:t.onUpdateReply,onOk:function(){return t.onOk()}})))};function lt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var st=function(t){var e=ut(Object(o.useState)(),2),n=e[0],i=e[1],a=ut(Object(o.useState)(""),2),c=a[0],l=a[1],u=Object(o.useRef)();Object(o.useEffect)((function(){i(t.annotation),l(""),u.current&&q(t.containerEl,u.current,t.bounds)}),[t.annotation]);var s=function(t){return i(n.clone({body:n.bodies.filter((function(e){return e!==t}))}))},d=function(e){var o=c.trim()?n.clone({body:[].concat(lt(n.bodies),[{type:"TextualBody",value:c.trim()}])}):n;o.isSelection?t.onAnnotationCreated(o.toAnnotation()):t.onAnnotationUpdated(o,t.annotation)};return t.open&&r.a.createElement("div",{ref:u,className:"r6o-editor"},r.a.createElement("div",{className:"arrow"}),r.a.createElement("div",{className:"inner"},r.a.createElement(W,null),r.a.createElement(ct,{annotation:n,currentReply:c,onUpdateComment:function(t,e){return i(n.clone({body:n.bodies.map((function(n){return n===t?e:n}))}))},onDeleteComment:s,onUpdateReply:function(t){return l(t.target.value.trim())},onOk:d}),r.a.createElement(V,{annotation:n,onAddTag:function(t){return i(n.clone({body:[].concat(lt(n.bodies),[t])}))},onRemoveTag:s}),t.readOnly?r.a.createElement("div",{className:"footer"},r.a.createElement("button",{className:"r6o-btn",onClick:t.onCancel},"Close")):r.a.createElement("div",{className:"footer"},r.a.createElement("button",{className:"r6o-btn outline",onClick:t.onCancel},"Cancel"),r.a.createElement("button",{className:"r6o-btn ",onClick:d},"Ok"))))};n(48);function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ht(t,e){return(ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gt=function(t){function e(){var t,n,o,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return o=this,r=(t=pt(e)).call.apply(t,[this].concat(a)),n=!r||"object"!==dt(r)&&"function"!=typeof r?bt(o):r,mt(bt(n),"state",{showEditor:!1,selectionBounds:null,selectedAnnotation:null}),mt(bt(n),"_clearState",(function(){n.setState({showEditor:!1,selectionBounds:null,selectedAnnotation:null})})),mt(bt(n),"handleSelect",(function(t){var e=t.selection,o=t.clientRect;e?n.setState({showEditor:!0,selectionBounds:o,selectedAnnotation:e}):n._clearState()})),mt(bt(n),"handleCancel",(function(){n._clearState(),n.selectionHandler.clearSelection()})),mt(bt(n),"handleCreateOrUpdate",(function(t){return function(e,o){n._clearState(),n.selectionHandler.clearSelection(),n.highlighter.addOrUpdateAnnotation(e,o),n.props[t](e,o)}})),mt(bt(n),"addAnnotation",(function(t){n.highlighter.addOrUpdateAnnotation(t)})),mt(bt(n),"removeAnnotation",(function(t){n.highlighter.removeAnnotation(t);var e=n.state.selectedAnnotation;e&&t.isEqual(e)&&n.setState({showEditor:!1})})),mt(bt(n),"setAnnotations",(function(t){n.highlighter.init(t)})),n}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ht(t,e)}(e,t),n=e,(o=[{key:"componentDidMount",value:function(){this.highlighter=new O(this.props.contentEl,this.props.formatter),this.selectionHandler=new L(this.props.contentEl,this.highlighter),this.selectionHandler.on("select",this.handleSelect)}},{key:"render",value:function(){return r.a.createElement(st,{open:this.state.showEditor,readOnly:this.props.readOnly,bounds:this.state.selectionBounds,containerEl:this.props.containerEl,annotation:this.state.selectedAnnotation,onAnnotationCreated:this.handleCreateOrUpdate("onAnnotationCreated"),onAnnotationUpdated:this.handleCreateOrUpdate("onAnnotationUpdated"),onCancel:this.handleCancel})}}])&&ft(n.prototype,o),i&&ft(n,i),e}(o.Component);function yt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"init",(function(){return wt}));var vt=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),yt(this,"handleAnnotationCreated",(function(t){n._emitter.emit("createAnnotation",t)})),yt(this,"handleAnnotationUpdated",(function(t,e){n._emitter.emit("updateAnnotation",t,e)})),yt(this,"handleAnnotationDeleted",(function(t){n._emitter.emit("deleteAnnotation",t)})),yt(this,"addAnnotation",(function(t){n._app.current.addAnnotation(new b(t))})),yt(this,"removeAnnotation",(function(t){n._app.current.removeAnnotation(new b(t))})),yt(this,"loadAnnotations",(function(t){return l.a.get(t).then((function(t){var e=t.data.map((function(t){return new b(t)}));return n._app.current.setAnnotations(e),e}))})),yt(this,"on",(function(t,e){n._emitter.on(t,e)})),yt(this,"off",(function(t,e){n._emitter.off(t,e)})),this._app=r.a.createRef(),this._emitter=new s.a;var o,i=e.content.nodeType?e.content:document.getElementById(e.content);"pre"!==e.mode&&(m([o=i]),i=o);var c=document.createElement("DIV");c.style.position="relative",i.parentNode.insertBefore(c,i),c.appendChild(i);var u=document.createElement("DIV");c.appendChild(u),a.a.render(r.a.createElement(gt,{ref:this._app,contentEl:i,containerEl:c,readOnly:e.readOnly,formatter:e.formatter,onAnnotationCreated:this.handleAnnotationCreated,onAnnotationUpdated:this.handleAnnotationUpdated,onAnnotationDeleted:this.handleAnnotationDeleted}),u)},wt=function(t){return new vt(t)}}})}));